---
title: "Productivity charts"
author: "Fabio A. Correa"
date: "February 1, 2020"
output:
  pdf_document:
    latex_engine: xelatex
mainfont: Calibri
sansfont: Calibri
monofont: Source Code Pro
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = TRUE,
	warning = TRUE,
	comment = NULL, # The default '##' leads every line of results in the final document
	fig.align = "center"
)
source("common.R")
if(!exists("taskr")) {
  if(file.exists("taskr.RData")) {
    # cat("taskr: ")
    load("taskr.RData", verbose = TRUE)
  } else {
    stop("Please create some tasks first. Use the taskr.R script and save to disk.\n")
  }
}
```

# Productivity visualization
```{r raster0}
tmp <- list()
tmp$tp <- taskr$t[taskr.re(date, -30, 60) & (state != "Abandoned")]
tmp$ncol <- trunc(sqrt(nrow(tmp$t)))
tmp$nrow <- trunc(1.5 * tmp$ncol)
tmp$coord <- as.data.table(expand.grid(x = 1:tmp$nrow, y = 1:tmp$ncol))
tmp$t <- cbind(tmp$coord[1:nrow(tmp$t)], tmp$tp)
tmp$t[, State := ifelse(state == "Pending", 1, 0.5)]
ggplot(tmp$t, aes(x = x, y = y, fill = projectName, alpha = State)) +
  geom_raster(hjust = 1, vjust = 1);
```
